<html>
<head>
    <script type="text/javascript" src="https://cdn.rawgit.com/almende/vis/master/dist/vis.js"></script>
    <link href="https://cdn.rawgit.com/almende/vis/master/dist/vis.css" rel="stylesheet" type="text/css" />

    <style type="text/css">
        #mynetwork {
            width: 1200px;
            height: 800px;
            border: 1px solid lightgray;
        }
    </style>
</head>
<body onload="draw();">

ASN: <input type="text" id="peeringASN" value="">

<p>Click the button to draw their Peering Infra. Please only input one ASN per button click (Will fix soon)</p>

<input type="button" onclick="updateGraph()" value="Draw it!"> <br />

<div id="mynetwork"></div>

<script type="text/javascript">
var nodes, edges, network, data, container;
var group = 0;

function updateGraph() {

    asn = document.getElementById("peeringASN").value
	var req = new XMLHttpRequest();
	req.open("GET", "https://unicast.network/api/net?depth=2&asn=" + asn, false);
	req.send(null);
	asnOne = JSON.parse(req.responseText);

	var ix_num = asnOne["data"][0]["netixlan_set"];
	var node,link;
	nodes.add([ {"id": asnOne["data"][0]["asn"], "label": asnOne["data"][0]["name"], "group": group } ]);
	for (var i = 0; i < ix_num.length; i++){
	    name =  ix_num[i]["name"];
		node = {"id": name, "label": ix_num[i]["name"]};
		node_c = {"id": name, "label": ix_num[i]["name"], color: "red"};
		link = {"to": name, "from": asnOne["data"][0]["asn"], };
                edges.add([link]);
		try { 
			nodes.add([node]);
			}
			catch(err){console.log("updating " + name ); nodes.update([{ id: name, color: "red" }])}

	}
	group++;
	network = new vis.Network(container, data, options);

}

function draw() {
	// create an array with nodes
	nodes = new vis.DataSet();
	// create an array with edges
	edges = new vis.DataSet();

	// create a network
	var container = document.getElementById('network');
	data = {
		nodes: nodes,
		edges: edges
	};
	var options = {};
	network = new vis.Network(container, data, options);

}

// create a network
var container = document.getElementById("mynetwork");

// provide the data in the vis format

var directionInput = "LR";
var options = {
			layout: {
				improvedLayout: true,
				randomSeed: 6,
				//hierarchical: {
				//	direction: directionInput,
				//	sortMethod: "directed",
				//	levelSeparation: 600,
				//	nodeSpacing: 100
				//}
			},
			physics: { 
				stabilization: true
			},
			interaction: {
				hover: true
			}
};

// initialize your network!

</script>
</body>
</html>
